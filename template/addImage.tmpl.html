<md-dialog aria-label="Mango (Fruit)"  ng-cloak style="padding:0;max-height: 100%; width:1000px;z-index:9999999">
<div class="modal-header c-modal-header" style="padding:5px;height:37px;">
    <button class="close dialog-close" data-dismiss="modal" type="button" style="display:inline-block">
     <span aria-hidden="True" class="c-span">
      ×
     </span>
     <span class="sr-only c-span">
      关闭
     </span>
        </button>
        <i class="fa fa-folder c-icon">
        </i>
        <h5 class="modal-title c-heading" style="display:inline-block">
          <i class=" icon-folder-close" style="margin-right:5px;"></i><span style="font-size:10px;">图库</span>
        </h5>
    
        <div class="" style="display:inline-block;float:right;margin-right:50px;">
          <input class="form-control" ng-model="query" placeholder="搜索图片" type="text" style="height: 25px;padding: 6px 6px;font-size: 10px;">
        </div>
      </div>


    <md-dialog-content style="padding:0;z-index:9999999;">
        <div class="piclaber" id="imgpop">
          <div class="leftTab">
            <ul>
              <li class="active">我的图库</li>
            </ul>
          </div>
          <div class="rightTab">
              <ul id="imageList">
                 <li class="myImg" style="width:140px; height:120px;" id="newImageTarget">
                 <form id='uploadImageForm' enctype='multipart/form-data'>
                          <input type="file" name="uploadImage" ng-model="uploadImageFile" style="width:140px;height:120px;opacity:0; z-index:99999;width:80px;position:absolute;"  onchange="angular.element(this).scope().uploadImage(this)" />
            </form>
                  <a type="button" class="btn btn-default" style="width: 140px;height: 120px;display: block;line-height: 100px;"><i class="icon-upload-alt icon-large"></i></a>
                 </li> 
         

                <li class="myImg" ng-repeat="item in imageList | filter:query | orderBy:order" id="{{item._id}}">
                <img class="myImageActive" src="{{item.url}}" >
                <div style="height:20px;width:100%;background-color:rgba(0,0,0,0.8);margin-top:-1px;">
                <span style="font-size:6px;color:#fff;float:left; padding:2px;">{{item.name.substring(-1,16)}}</span>
                </div>
                <div style="position:absolute;top:0px;left:0px;background-color:rgba(0,0,0,0.8);width:140px;height:120px;opacity:0;text-align:center;" class="imageOption">
                <a style="z-index:9999;color:#fff; margin-right:20px;display:inline-block;line-height:120px;" class="removeImageHover" ng-click="removeImage(item._id)">
                <i class=" icon-trash icon-2x" ></i></a>
                <a style="z-index:9999;color:#fff;display:inline-block;line-height: 120px;" class="selectedImageHover" ng-click="imageSelected(item.url)"><i class="icon-ok-sign icon-2x" ></i></a>
                </div>
              </li>
              </ul>
          </div>
          <span class="glyphicon glyphicon-remove close"></span>
        </div>
    
    </md-dialog-content>
</md-dialog>
  

<script type="text/javascript">

//   $("#uploadImage").change(function(){    
//     $.ajax({
//         beforeSend : function (){
//           // var newUpload = $('<li class="myImg imageInProgress"><img src="images/logo.jpg" style="width:60px;height:30px;"/><div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width:0%;height:2px;"><span class="sr-only">60% Complete</span></div></li>');
//           //    newUpload.prependTo($("#imageList"));
//       },
//      xhrFields: {
//             onprogress: function (evt) {
//                if (evt.lengthComputable) {
//                  var percentComplete = Math.floor(evt.loaded / evt.total) * 100 + '%';
//                  $('.progress-bar').css({width : percentComplete});
//                }
//             }
//          },
//         url: "http://9.115.24.168:3000/uploadImage",
//         type: "POST",
//         data: new FormData($('#uploadImageForm')[0]), 

//         success : function(data){
//             // Show success message
//             console.log(data.image.url+"||"+data.image.name);

//             var newImageReady = $('<li  class="myImg" id="'+data.image._id+'"><img class="myImageActive" src="'+data.image.url+'" ><div style="height:20px;width:100%;background-color:rgba(0,0,0,0.8);margin-top:-1px;"><span style="font-size:6px;color:#fff;float:left; padding:2px;">'+data.image.name+'</span></div><div style="position:absolute;top:0px;left:0px;background-color:rgba(0,0,0,0.8);width:140px;height:120px;opacity:0;text-align:center;" class="imageOption"><a style="z-index:9999;color:#fff; margin-right:20px;display:inline-block;line-height:120px;" class="removeImageHover" ng-click="removeImage($event,'+data.image._id+')"><i class=" icon-trash icon-2x" ></i></a><a style="z-index:9999;color:#fff;display:inline-block;line-height: 120px;" class="selectedImageHover" ng-click="imageSelected('+data.image.url+')"><i class="icon-ok-sign icon-2x" ></i></a></div></li>');
//            setTimeout(function(){
//              newImageReady.prependTo($('#imageList'));

//            },200)
//         },
//         enctype: 'multipart/form-data',
//         processData: false,
//         contentType: false,
//         cache: false
//     });
// });





 


// $("#uploadImage").change(function(){
//          //创建FormData对象
//          var data = new FormData();
//          //为FormData对象添加数据
//          $.each($('#uploadImage')[0].files, function(i, file) {
//              data.append('upload_file'+i, file);
//          });
//          $(".loading").show();    //显示加载图片
//          //发送数据
//          $.ajax({
//              url:'http://9.115.24.168:3000/uploadImage',
//              type:'POST',
//              data:new FormData($('#uploadImage')[0].files),
//              cache: false,
//              contentType: false,        //不可缺参数
//              processData: false,        //不可缺参数
//              success:function(data){
//                  data = $(data).html();
//                  //第一个feedback数据直接append，其他的用before第1个（ .eq(0).before() ）放至最前面。
//                  //data.replace(/&lt;/g,'<').replace(/&gt;/g,'>') 转换html标签，否则图片无法显示。
//                  if($("#feedback").children('img').length == 0) $("#feedback").append(data.replace(/&lt;/g,'<').replace(/&gt;/g,'>'));
//                  else $("#feedback").children('img').eq(0).before(data.replace(/&lt;/g,'<').replace(/&gt;/g,'>'));
//                  $(".loading").hide();    //加载成功移除加载图片
//              },
//              error:function(){
//                  alert('上传出错');
//                  $(".loading").hide();    //加载失败移除加载图片
//              }
//          });
//      });

  // $.ajax({ 
  // //   xhr: function() {
  // //   var xhr = new window.XMLHttpRequest();
  // //   xhr.upload.addEventListener("progress", function(evt) {
  // //     if (evt.lengthComputable) {
  // //       var percentComplete = evt.loaded / evt.total;
  // //       percentComplete = parseInt(percentComplete * 100);
  // //       console.log(percentComplete+"loading ................");

  // //       if (percentComplete === 100) {

  // //       }

  // //     }
  // //   }, false);

  // //   return xhr;
  // // },
  //       url: "http://9.115.24.168:3000/uploadImage",
  //       type: "POST",
  //       data: new FormData($('#uploadImageForm')[0]), 

  //       success : function(data){
  //           // Show success message
  //           console.log(data.url+"..............");
  //       },
  //       enctype: 'multipart/form-data',
  //       processData: false,
  //       contentType: false,
  //       cache: false
  //   });






$(document).on("mouseenter",".myImg",function(){
     $(this).find('.imageOption').stop().delay(50).animate({opacity:1},200);
});
$(document).on("mouseleave",".myImg",function(){
    $(this).find('.imageOption').stop().delay(50).animate({opacity:0},200);
    // $('#container').css('filter','blur(5px)');
});
$(document).on("mouseenter",".imageOption",function(){
    $(this).find(".selectedImageHover").stop().delay(50).animate({color:"#00CC99"},200);

});
$(document).on("mouseleave",".imageOption",function(){
    $(this).find(".removeImageHover").stop().delay(50).animate({color:"#00CC99"},200);
});

</script>

</script>